(function(e){function a(g,h,i,f){f.addClass("ajax_loading");e.ajax({dataType:"jsonp",jsonp:"jsonCallback",url:h,data:"docId="+g,success:function(j){e(f).removeClass("ajax_loading");if(typeof i==="function"){i(j);}}});}function c(p){var m,l,k,h,o,n,f=[],q=[];for(m=0,k=p.length;m<k;m++){o=p[m];f=o.prices;var g=[];for(l=0,h=f.length;l<h;l++){n=f[l];g.push([n.time,parseFloat(n.price,10)]);}q.push({"name":o.site,"data":g});}return q;}function d(i){var h=i.price;var g=i.site;var f={averiageType:0,nowPrice:{price:h},averiage:[{prices:b(h),site:g}]};return f;}function b(j){var h=[];var f=new Date().getTime()-89*86400000;for(var g=0;g<90;g++){h.push({"price":j,"time":f});f=f+86400000;}return h;}Highcharts.setOptions({global:{useUTC:false}});e.fn.b5mtrend=function(f,h,g){var j={chart:{type:"spline",style:{overflow:"visible"}},colors:["#E97D01","#D24A7D","#64AD10","#0C7F1A","#1C98C5","#4F90B5","#EECFA1","#EE82EE","#DB7093","#BFEFFF"],title:{text:"",align:"left",style:{color:"#3E576F",fontSize:"14px"}},tooltip:{xDateFormat:"%Y-%m-%d",shared:true,valuePrefix:"ï¿¥",backgroundColor:"#ffffff",borderWidth:1,borderColor:"#E97D01",crosshairs:[{color:"#ff1919",width:1},{color:"#ff1919",width:1}],style:{color:"#333333",fontSize:"12px",padding:"8px"}},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%m-%d",week:"%m-%d",month:"%m-%d"},alternateGridColor:"#eeeeee",minorGridLineColor:"#dfdfdf",minorTickInterval:"auto"},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}],gridLineColor:"#c0d0e0",minorGridLineColor:"#dfdfdf",minorTickInterval:"auto"},plotOptions:{spline:{lineWidth:2,states:{hover:{lineWidth:2}},marker:{enabled:false}}},legend:{layout:"horizontal",align:"center",verticalAlign:"bottom",borderWidth:0,margin:10},credits:{enabled:false,href:"http://www.b5m.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-15},text:"www.b5m.com"},series:[]};var i=e.extend(true,{},j);if(g.height){i.chart.height=g.height;}if(g.width){i.chart.width=g.width;}if(g.titleText){i.title.text=g.titleText;}if(g.titleAlign){i.title.align=g.titleAlign;}if(g.colors){i.chart.colors=g.colors;}i.tooltip.crosshairs=i.tooltip.crosshairs||[{},{}];if(!g.crosshairsEnableds){g.crosshairsEnableds=[true,true];}if(g.crosshairsEnableds&&g.crosshairsEnableds.length>=2){if(g.crosshairsEnableds[0]===false){i.tooltip.crosshairs[0]=null;}else{i.tooltip.crosshairs[0].color=g.crosshairsColor[0];i.tooltip.crosshairs[0].width=1;}if(g.crosshairsEnableds[1]===false){i.tooltip.crosshairs[1]=null;}else{i.tooltip.crosshairs[1].color=g.crosshairsColor[1];i.tooltip.crosshairs[1].width=1;}}if(g.legendEnabled!=null){i.legend={enabled:g.legendEnabled};}var k=this;a(f,h,function(q){var p;if(!q.val){if(g.price&&g.site){if(!p||p[0].prices.length==0){q={};q.val=d(g);}}}if(g.handler&&(typeof g.handler==="function")){p=g.handler(q);}else{if(q){p=q.val;}}if(p){var n=c(p);i.series=n.slice(0,10);e(k).highcharts(i);var o=e(k).highcharts();if(o&&o.series){var l=o.series;for(var m=1;m<l.length;m++){l[m].hide();}l[0].show();}e(".highcharts-legend-item text,path").on("click",function(){if(e("g.highcharts-legend-item").find('path[stroke!="#CCC"]').length==1&&e(this).parent().find("path").attr("stroke")!="#CCC"){return false;}});}},k);};}(jQuery));